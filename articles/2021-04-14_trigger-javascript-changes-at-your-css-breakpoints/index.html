<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Trigger JavaScript changes at your CSS breakpoints | andy-blum.com</title><style>:where(:not(html,iframe,canvas,img,svg,video,audio):not(svg *,symbol *)){all:unset;display:revert}*,::after,::before{box-sizing:border-box}a,button{cursor:revert}:is(ol,ul):not(.plain){list-style:initial;list-style-position:inside}:is(ol,ul,menu).plain,nav :is(ol,ul,menu):not(.plain){list-style:none}img{max-inline-size:100%;max-block-size:100%}table{border-collapse:collapse}input,textarea{-webkit-user-select:auto}textarea{white-space:revert}meter{-webkit-appearance:revert;appearance:revert}:where(pre){all:revert}::placeholder{color:unset}::marker{content:initial}:where([hidden]){display:none}:where([contenteditable]:not([contenteditable=false])){-moz-user-modify:read-write;-webkit-user-modify:read-write;overflow-wrap:break-word;-webkit-line-break:after-white-space;-webkit-user-select:auto}:where([draggable=true]){-webkit-user-drag:element}:where(dialog:modal){all:revert}:root{--dark:#2a2a2a;--light:#eee;--white:#fff;--accent:#0076D1}@media (prefers-color-scheme:dark){:root{--dark:#ddd;--light:#333;--white:#111;--accent:#1A9CFF}}header{width:900px;max-width:calc(100% - 2em);margin:0 auto;padding:2em 0;display:flex;flex-wrap:wrap;justify-content:space-between}header nav ul{display:flex;gap:1em}header::after{content:'';display:block;height:5px;border-radius:999px;background-color:var(--accent);flex:1 1 100%;margin-top:1em}main{width:900px;margin:0 auto;max-width:calc(100% - 2em)}.visually-hidden:not(:focus){position:absolute!important;overflow:hidden;clip:rect(1px,1px,1px,1px);width:1px;height:1px;word-wrap:normal}img,picture,picture source{max-width:100%;height:auto;border-radius:7px}.post-preview{margin:0 0 1rem;padding:1rem;border:1px solid var(--dark);border-radius:4px}.post-preview .post-title{display:block;font-size:1.25rem}.post-preview .post-date{display:block}.pagination ul{display:flex;gap:1rem;justify-content:center}@font-face{font-family:Recursive;font-style:oblique 0deg 15deg;font-weight:300 1000;font-display:swap;src:url('/assets/recursive.woff2') format('woff2')}html{background:var(--white);color:var(--dark);font-family:Recursive,sans-serif;font-weight:400;font-variation-settings:'MONO' 0,'slnt' 0,'CRSV' 0;font-size:18px;line-height:1.75}*+:is(
h1,h2,h3,h4,h5,h6,p,blockquote,pre,fieldset,form,table,article,details,figure,audio,video,iframe,.highlighter-rouge,ol,ul
){margin-top:1em}:is(h1,h2,h3,h4,h5,h6){font-variation-settings:'wght' 800,'slnt' -15,'CRSV' 0;line-height:1.25}:is(h1,h2,h3,h4,h5,h6):not(:last-child){margin-bottom:1em}h1{font-size:2.5em}h2{font-size:2em}h3{font-size:1.75em}h4{font-size:1.5em}h5{font-size:1.1em}h6{font-size:1em}a{color:var(--accent);text-decoration:none}a:is(:hover,:focus){text-decoration:underline}strong{font-weight:bolder}small{font-size:.85em}svg{fill:currentColor;height:1em;width:1em}pre{font-size:inherit;display:block;position:relative;margin-left:auto;margin-right:auto;margin-bottom:2.5em;max-width:80ch;font-family:Recursive,monospace;line-height:1.5;font-variation-settings:'wght' 300;font-size:15px;background:#111;border:2px solid #555;border-top:none;color:#fff;padding:0;border-radius:10px;overflow:hidden;box-shadow:0 5px 10px 5px rgba(0,0,0,.3)}pre code{display:block;width:100%;overflow-x:scroll;padding:1em;background-color:transparent}pre code.hljs{background:inherit;color:inherit;padding:1em}pre:before{content:'';display:block;background:#555;width:100%;height:1.5em;border-radius:10px 10px 0 0}pre:after{content:'';display:block;position:absolute;top:.8em;left:.75em;transform:translateY(-50%);width:.75em;height:.75em;background:#f08080;border-radius:50%;box-shadow:1.1em 0 0 0 #daa520,2.2em 0 0 0 #3cb371}code{font-family:Recursive,monospace;font-variation-settings:"MONO" 1,"wght" 300;background-color:var(--light);padding:0 .25em}</style><link rel="stylesheet" href="/assets/highlight.min.css"></head><body><a class="visually-hidden" href="#main-content">Skip to the main content</a><header role="banner" class="site-head"><nav class="" aria-label="Site Navigation"><ul class="nav__list"><li><a href="/">Home</a></li><li><a href="/articles/" data-state="active">Articles</a></li><li><a href="/talks/">Talks</a></li><li><a href="/media/">Media</a></li></ul></nav><nav><ul><li><a rel="me" href="https://github.com/andy-blum/"><span class="visually-hidden">Github</span> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></a></li><li><a rel="me" href="https://www.drupal.org/u/andy-blum"><span class="visually-hidden">Drupal</span> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M319.5 114.7c-22.2-14-43.5-19.5-64.7-33.5-13-8.8-31.3-30-46.5-48.3-2.7 29.3-11.5 41.2-22 49.5-21.3 17-34.8 22.2-53.5 32.3C117 123 32 181.5 32 290.5 32 399.7 123.8 480 225.8 480 327.5 480 416 406 416 294c0-112.3-83-171-96.5-179.3zm2.5 325.6c-20.1 20.1-90.1 28.7-116.7 4.2-4.8-4.8.3-12 6.5-12 0 0 17 13.3 51.5 13.3 27 0 46-7.7 54.5-14 6.1-4.6 8.4 4.3 4.2 8.5zm-54.5-52.6c8.7-3.6 29-3.8 36.8 1.3 4.1 2.8 16.1 18.8 6.2 23.7-8.4 4.2-1.2-15.7-26.5-15.7-14.7 0-19.5 5.2-26.7 11-7 6-9.8 8-12.2 4.7-6-8.2 15.9-22.3 22.4-25zM360 405c-15.2-1-45.5-48.8-65-49.5-30.9-.9-104.1 80.7-161.3 42-38.8-26.6-14.6-104.8 51.8-105.2 49.5-.5 83.8 49 108.5 48.5 21.3-.3 61.8-41.8 81.8-41.8 48.7 0 23.3 109.3-15.8 106z"/></svg></a></li><li><a rel="me" href="https://drupal.community/@andy_blum"><span class="visually-hidden">Mastodon</span> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/andyblum/"><span class="visually-hidden">LinkedIn</span> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg></a></li></ul></nav></header><main tabindex="-1" id="main-content"><article><h1>Trigger JavaScript changes at your CSS breakpoints</h1><p><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Responsive_Design">Responsive web design</a> has been around for a while, and is definitely the preferred way to handle displaying your website to users across a virtually infinite number of device types, shapes, and sizes. While the use of media queries is pretty well established and wide-spread for targeting specific CSS rules, what if you wanted to use device width or some other media query to trigger <em>your javascript?</em></p><h2>Web APIs to the rescue</h2><p>Web APIs are a marvelous thing, offloading a lot of work from the single-thread-limited javascript engines into the browser application itself to keep your web experience snappy and performant. In this case, the Window API provides a method <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia#browser_compatibility">matchMedia</a> which allows us to effectively copy and paste our breakpoints from our S/CSS into our javascript. It works like this:</p><ol><li>Enter your media query as a string like <code>window.matchMedia('(min-width:640px)')</code></li><li>That returns a <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList">MediaQueryList</a> object</li><li>Use the MediaQueryList's <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/matches">matches</a> property to get a boolean value indicating if that media query matches at the time of code execution</li></ol><p>For example, consider a design with a side bar that can toggle between two states, open and closed. To make this simple on yourself, you can make the side bar default to a 'closed' state in your CSS and open it when the class 'open' is applied. This limits the javascript needed to a single click event listener on a button somewhere in the DOM.</p><pre><code class="language-js">const toggleButton = document.querySelector('#sidebar-toggle-button');

toggleButton.addEventListener('click', () =&gt; {
  const sidebar = document.querySelector('#sidebar-region');

  sidebar.classList.toggle('open');
});
</code></pre><p>Now, your sidebar toggle button will listen for the click event, and toggle the existence of the 'open' class on your sidebar. But what if we want the sidebar to be open by default for users on desktop-sized screens? Well, we could get a little wild with our CSS and write media queries for our sidebar to have it open by default on large screens, but now when a user clicks the button, it'll add the 'open' class to an already-open sidebar. One of my favorite things about web development is that there's a hundred ways to solve any given problem, but I think the easiest one in this case is to borrow our media queries from our CSS in our javascript.</p><p>We'll need to account for a few things:</p><ol><li>Check the media query on page load to see if the sidebar should be open</li><li>Check the media query on resize, to close the sidebar if we cross under the width threshold or open it if we cross over the threshold.</li></ol><h2>1. Check the media query on page load</h2><p>Anyone that has written jQuery will remember starting scripts with <code>$( document ).ready()</code> where we had to wait for the document to be fully loaded and ready for our scripts to run. We don't necessarily want our scripts to run while the page is still parsing the DOM just in case the part of the DOM we're going to interact with isn't ready yet. In the case of vanilla JS, we can use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/DOMContentLoaded_event">DOMContentLoaded</a> event to wait for the browser to finish parsing the DOM, or the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event">load</a> event if we're in even less of a rush to wait for the browser to finish retrieving all additional resources like images and stylesheets.</p><pre><code class="language-js">const mediaQuery = window.matchMedia('(min-width:640px)');

document.addEventListener('DOMContentLoaded', () =&gt; {
  if (mediaQuery.matches) {
    const sidebar = document.querySelector('#sidebar-region');

    sidebar.classList.add('open');
  }
});
</code></pre><h2>2. Listen for changes on the media query</h2><p>We can also use the MediaQueryList object stored as <code>mediaQuery</code> in the above example to listen for when the browser crosses our threshold. In our hypothetical case here, we'll listen for crossing the boundary to close an open sidebar when the screen shrinks, and to open a closed sidebar when the screen expands.</p><pre><code class="language-js">const mediaQuery = window.matchMedia('(min-width:640px)');

mediaQuery.addEventListener('change', () =&gt; {
  if (mediaQuery.matches) {
    const sidebar = document.querySelector('#sidebar-region');

    sidebar.classList.add('open');
});
</code></pre></article></main><script src="/assets/highlight.min.js"></script></body></html>